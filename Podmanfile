FROM docker.io/library/python:3.12-slim AS builder
WORKDIR /build
RUN pip install --no-cache-dir mkdocs mkdocs-material
COPY mkdocs.yml .
COPY docs/ docs/
RUN mkdocs build --clean

FROM docker.io/caddy/caddy:2-alpine
COPY --from=builder /build/site /srv
COPY Caddyfile /etc/caddy/Caddyfile
RUN mkdir -p /etc/caddy/snippets
EXPOSE 80
